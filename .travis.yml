dist: trusty
sudo: required
services:
- docker
language: node_js
node_js:
- 9.5.0
branches:
  except:
  - "/\\+travis\\.\\d+$/"
  - "/^\\d+\\.\\d+\\.\\d+-.*\\d+$/"
env:
  global:
  - ATOMIST_TEAM=T29E48P34
  - NPM_PUBLISH=true
  - NPM_REGISTRY=https://atomist.jfrog.io/atomist/api/npm/npm-dev-local
  - secure: RI7ky0satYk14phJ0QhvmMOiG6oM4Ftz2lh5YGlC9RsSZ/jLdVdSraTDt0j6SM7yL2BG6gQ5g/ljyH/7Q/fyuwwJA9SNpreCN2glSIr1HJ9cmZzmzwyhzQN7gSNu1lpqh5KhyhguBJ4/YaNiB4d1WCaXt6jA4SU503/oZPzVhZLxag9wJvLnSs+9enHIos0yBPg3kgd2H85niGKuEd0/XKTqCKr6ZLPbB9MCDvOKk/lvMDyddME4YwSWjqowkP86f0VRP7NGWcrdy5y/sGORPNOUFAZ/UJ3TiiU/KHOM1fDF9cxE8nT3GAsSQw9du+dl3REVwzfiS8hMOjLDiWFMUjbfzi6YJdWh3tYlAEZUArhmXj3+r2rkKXa5kG9cAnQwu1HSnmph58MgtNij+9Kk/wnB/obGw5jjTNrc1g8GkDnI8qPUuVkvXVBX7VC2YBNAr7gz6RCgc/C2XGXxOAFTHoKLc29llQ8/l3ZRedc6GngiJU/cPrA+iE1/PE9atotjgMmidi2SH5tnG/qeqdIzY+Fc2c5MZKHOu+5PJa8YFyHGKj7mLYUvnufw+NCvcZq5JbEeLg005IlITT9o1mKEurlGaP5sm4/nD6gFG8XEu04AftDmCxJxZfr0T3NIXwN/6UmpFC/y8p93j1ujbED59oM5lkkGSIh7dlPs6Njyv+4=
  - DOCKER_REGISTRY=atomist
  - DOCKER_USER=atomist
  - secure: Wm9XO+j+FRqOfhJ0bkLsOd9NJ7DBXWcD33MZKhQqfZhbHsyLp48rAot+/jL5YRQXcQjV08uwxHDzfjJQXQlNs8609gKpgSs2/fMX4HYVvWRdFqAsUSIXYoDDk8G8fuqiM6lWveciSxJCvB0xjg44QomtxCJc4o+rRDcrvOuVQjGMWjeiOTfjgQqAoemamb6C0/mMQyz8qVobHQMJoByO4lumtOwsbj0ZOMv5QJziUlwxBTLuCg9OZf7RPjGS2sj7kxIMY2PipifZ7QBqCm61IiGNNKRlfE33YMLfodQujjA4L5XrCFzcps0p9i9MkpS2JCMmIWpCNSnU9iRgQeqiSf98lcj+oBXUR0m2cirtkglCNuhI8AnIl2PTLcJlSbpRubIjnqKeCOMqWIVozzpiJ7XoJoZPGVzEJjzovR30YUP3veUhWHSSaLNykjFlu7Q8whsqcUPqCBrh2pMHyhyUEtha3VUoLNAB6HWS+T58V5v2TNzNTpBbHRjIG8NbAosFvPBWtMZymLQTPuZgKNlMfLhQ7GeR/flrTlh+cMACNPCgoVrkd3HpeQQjAl+EhRmGsphPkTSh50X/WTYTye9SomU3X9OtiusXgVVlIHTGhnmsm4oXR4Rp41YunBW/DoPGw7/V+RgZeU+1a6oKHStBBjRrPB4pR+5KJY59esdd6rY=
before_install:
- openssl aes-256-cbc -K $encrypted_536606bad75a_key -iv $encrypted_536606bad75a_iv
  -in .npmrc.enc -out .npmrc -d
script: bash scripts/travis-build.bash
notifications:
  email: false
  webhooks:
    urls:
    - https://webhook.atomist.com/atomist/travis/teams/T29E48P34
    on_success: always
    on_failure: always
    on_start: always
    on_cancel: always
    on_error: always
before_deploy:
- touch build/typedoc/.nojekyll
deploy:
- provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  local_dir: build/typedoc
  on:
    tags: true
    condition: "$TRAVIS_TAG =~ ^[0-9]+\\.[0-9]+\\.[0-9]+(-(m|rc)\\.[0-9]+)?$"
- provider: releases
  api_key: "$GITHUB_TOKEN"
  on:
    tags: true
    condition: "$TRAVIS_TAG =~ ^[0-9]+\\.[0-9]+\\.[0-9]+(-(m|rc)\\.[0-9]+)?$"
